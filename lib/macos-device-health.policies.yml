- description: This policy checks if FileVault (disk encryption) is enabled.
  name: macOS - Enable FileVault
  platform: darwin
  query: SELECT 1 FROM filevault_status WHERE status = 'FileVault is On.';
  resolution: As an IT admin, turn on disk encryption in Fleet.
- description: This policy checks if the guest account is disabled.
  name: macOS - Disable guest account
  platform: darwin
  query: SELECT 1 FROM managed_policies WHERE domain='com.apple.loginwindow' AND username = '' AND name='DisableGuestAccount' AND CAST(value AS INT) = 1;
  resolution: An an IT admin, deploy a macOS, login window profile with the DisableGuestAccount option set to true.
- description: This policy checks if Firewall is enabled.
  name: macOS - Enable Firewall
  platform: darwin
  query: SELECT 1 FROM managed_policies WHERE domain='com.apple.security.firewall' AND username = '' AND name='EnableFirewall' AND CAST(value AS INT) = 1;
  resolution: An an IT admin, deploy a macOS, Firewall profile with the EnableFirewall option set to true.
- description: This policy checks if the end user is required to enter a password, with at least 10 characters, to unlock the host.
  name: macOS - Require 10 character password
  platform: darwin
  query: "SELECT 1 WHERE \n  EXISTS (\n    SELECT 1 FROM managed_policies WHERE \n        domain='com.apple.screensaver' AND \n        name='askForPassword' AND \n        CAST(value AS INT)\n    )\n  AND EXISTS (\n    SELECT 1 FROM managed_policies WHERE \n        domain='com.apple.screensaver' AND \n        name='minLength' AND \n        CAST(value AS INT) <= 10\n    );\n"
  resolution: An an IT admin, deploy a macOS, screensaver profile with the askForPassword option set to true and minLength option set to 10.
- description: This policy checks if maximum amount of time (in minutes) the device is allowed to sit idle before the screen is locked. End users can select any value less than the specified maximum.
  name: macOS - Enable screen saver after 20 minutes
  platform: darwin
  query: "SELECT 1 WHERE \n  EXISTS (\n    SELECT 1 FROM managed_policies WHERE \n        domain='com.apple.screensaver' AND \n        name='idleTime' AND \n        CAST(value AS INT) <= 1200 AND \n        username = ''\n    )\n  AND NOT EXISTS (\n    SELECT 1 FROM managed_policies WHERE \n        domain='com.apple.screensaver' AND \n        name='idleTime' AND \n        CAST(value AS INT) > 1200\n    );\n"
  resolution: An an IT admin, deploy a macOS, screen saver profile with the maxInactivity option set to 20 minutes.
